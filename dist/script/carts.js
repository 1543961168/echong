"use strict";!function(s){var i;s(document).ready(function(){s("header").load("header.html"),s("footer").load("footer.html")}),i=s(".hk>ul>li"),s(".hk>ul>li").hover(function(){var i=s(this).offset().left-s(this).outerWidth()-51;s(this).addClass("hkactive").siblings("li").removeClass("hkactive"),console.log(i),s(".hkspan").css("marginLeft",i)},function(){s(".hkspan").css("marginLeft","0"),i.eq(0).addClass("hkactive").siblings("li").removeClass("hkactive")});var o,c,d=s(".item-list"),n=s(".anum"),t=s(".tprice"),e=s(".allsel"),a=s(".numadd"),l=s(".numdel"),h=s(".numinput input"),r=s(".danshan>a"),p=s(".allshan a"),u=s(".goodslie:visible").find(":checkbox"),f=[],m=[];function k(){var o=0,e=0;s(".goodslie:visible").each(function(i,n){s(n).find(".cartcheck input").prop("checked")&&(o+=parseInt(s(n).find(".numinput input").val()),e+=parseFloat(s(n).find(".asum strong").html()))}),n.find("em").html(o),t.html(e.toFixed(2))}function g(i){return(parseFloat(i.parents(".goodslie").find(".aprice strong").html())*parseInt(i.parents(".goodslie").find(".numinput input").val())).toFixed(2)}function v(){m=s.cookie("cookiesid")&&s.cookie("cookienum")?(f=s.cookie("cookiesid").split(","),s.cookie("cookienum").split(",")):(f=[],[])}function b(i){v();var n=i.parents(".goodslie").find("img").attr("sid");m[s.inArray(n,f)]=i.parents(".goodslie").find(".numinput input").val(),s.cookie("cookienum",m,{expires:10,path:"/"})}function x(o,i){var e=-1;s.each(i,function(i,n){o===n&&(e=i)}),i.splice(e,1),m.splice(e,1),s.cookie("cookiesid",i,{expires:10,path:"/"}),s.cookie("cookienum",m,{expires:10,path:"/"})}s.cookie("cookiesid")&&s.cookie("cookienum")&&(o=s.cookie("cookiesid").split(","),c=s.cookie("cookienum").split(","),s.each(o,function(i,n){var e,t;e=o[i],t=c[i],s.get({url:"http://10.31.162.28/echong/php/alldata.php",dataType:"json"}).then(function(i){s.each(i,function(i,n){var o;e==n.sid&&((o=s(".goodslie:hidden").clone(!0,!0)).find(".goodurl").find("img").attr("src",n.url),o.find(".goodurl").find("img").attr("sid",n.sid),o.find(".goodstitle").find("a").html(n.title),o.find(".aprice").find("strong").html(n.price),o.find(".numinput").find("input").val(t),o.find(".asum").find("strong").html((n.price*t).toFixed(2)),o.css("display","block"),d.append(o),k())})})})),e.on("change",function(){s(".goodslie:visible").find(":checkbox").prop("checked",s(this).prop("checked")),e.prop("checked",s(this).prop("checked")),k()}),d.on("change",u,function(){s(".goodslie:visible").find(":checkbox").length===s(".goodslie:visible").find("input:checked").size()?e.prop("checked",!0):e.prop("checked",!1),k()}),a.on("click",function(){var i=s(this).parents(".goodslie").find(".numinput input").val();i++,s(this).parents(".goodslie").find(".numinput input").val(i),s(this).parents(".goodslie").find(".asum strong").html(g(s(this))),k(),b(s(this))}),l.on("click",function(){var i=s(this).parents(".goodslie").find(".numinput input").val();--i<1&&(i=1),s(this).parents(".goodslie").find(".numinput input").val(i),s(this).parents(".goodslie").find(".asum strong").html(g(s(this))),k(),b(s(this))}),h.on("input",function(){var i=s(this).val();/^\d+$/g.test(i)||s(this).val(1),s(this).parents(".goodslie").find(".asum strong").html(g(s(this))),k(),b(s(this))}),r.on("click",function(){v(),window.confirm("你确定要删除吗?")&&(s(this).parents(".goodslie").remove(),x(s(this).parents(".goodslie").find("img").attr("sid"),f),k())}),p.on("click",function(){v(),window.confirm("你确定要全部删除吗?")&&(s(".goodslie:visible").each(function(){s(this).find(":checkbox").is(":checked")&&(s(this).remove(),x(s(this).find("img").attr("sid"),f))}),k())})}(jQuery);